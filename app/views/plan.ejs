<% include header %>
<nav class="navbar navbar-inverse navbar-fixed-top">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
              data-target="#navbar" aria-controls="navbar" aria-expanded="collapse">
        <span class="sr-only">Toggle</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a href="#" class="navbar-brand"><span>黄陵分公司</span></a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav navbar-right">
        <li class="active"><a href="/plan">计划统计</a></li>
        <li><a href="/ht">合同统计</a></li>
        <li><a href="/outstore">出库统计</a></li>
        <li><a href="/js">寄售统计</a></li>
        <li><a href="#">Sai <span class="glyphicon glyphicon-user"></span></a></li>
        <li><a href="#">注销 <span class="glyphicon glyphicon-log-out"></span></a></li>
      </ul>
      <form action="#" class="navbar-form navbar-right">
        <div class="input-group">
          <input type="text" class="form-control" name="tser" id="tser" placeholder="Search..">
          <span class="input-group-btn" id='bsaddo1'>
            <button class="btn btn-default">Go!</button>
          </span>
        </div>
      </form>
    </div>
  </div>
</nav>
<div class="container-fluid">
  <div class="row">
    <div class="col-md-2 col-sm-3 sidebar">
      <ul class="nav nav-sidebar">
        <li class="active"><a href="/plan">计划统计
            <span class="sr-only">(current)</span>
          </a></li>
        <li><a href="/ht">合同统计</a></li>
        <li><a href="/outstore">出库统计</a></li>
        <li><a href="/js">寄售统计</a></li>
      </ul>
    </div>
    <div class="col-md-10 col-md-offset-2 col-sm-9 col-sm-offset-3">
      <div class="panel panel-default">
        <div class="panel-heading">

        </div>
        <div class="panel-body table-responsive">
          <div class="row">
            <div style="height: 300px" class="col-md-6 col-sm-12">
              <div id='c1' style="height: 95%;width:95%;"></div>
            </div>
            <div style="height: 300px" class="col-md-6 col-sm-12">
              <div id='c2' style="height: 95%;width:95%;"></div>
            </div>
          </div>
          <hr>
          <table class="table table-striped table-hover table-condensed">
            <thead>
            <th>序号</th>
            <th>月份</th>
            <th>材料</th>
            <th>设备</th>
            <th>配件</th>
            <th>集采</th>
            </thead>
            <tbody>
            <tr>
              <td>1</td>
              <td>2016-01</td>
              <td>1400</td>
              <td>800</td>
              <td>500</td>
              <td>420</td>
            </tr>
            <tr>
              <td>2</td>
              <td>2016-02</td>
              <td>1400</td>
              <td>800</td>
              <td>500</td>
              <td>420</td>
            </tr>
            <tr>
              <td>3</td>
              <td>2016-03</td>
              <td>1400</td>
              <td>800</td>
              <td>500</td>
              <td>420</td>
            </tr>
            <tr>
              <td>4</td>
              <td>2016-04</td>
              <td>1400</td>
              <td>800</td>
              <td>500</td>
              <td>420</td>
            </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
</div>
<script>
  $(document).ready(function () {
    var myChart = echarts.init($('#c1').get(0));
    var myChart2 = echarts.init($('#c2').get(0));
    // 指定图表的配置项和数据
    option = {
      title: {
        text: '计划统计',
        x: 'center',
        top: '-5'
      },
      tooltip: {
        trigger: 'axis',
        axisPointer: {            // 坐标轴指示器，坐标轴触发有效
          type: 'shadow'        // 默认为直线，可选为：'line' | 'shadow'
        }
      },
      legend: {
        data: ['设备', '配件', '材料', '集采'],
        x: 'center',
        top: '30'
      },
      grid: {
        left: '2%',
        right: '2%',
        bottom: '2%',
        containLabel: true
      },
      xAxis: [
        {
          type: 'category',
          data: ['2016-01', '2016-02', '2016-03', '2016-04', '2016-05', '2016-06', '2016-07', '2016-08', '2016-09', '2016-10', '2016-11', '2016-12']
        }
      ],
      yAxis: [
        {
          type: 'value'
        }
      ],
      series: [
        {
          name: '设备',
          type: 'bar',
          stack: '计划',
          data: [200, 332, 301, 334, 390, 330, 0, 0, 0, 0, 0, 0]
        },
        {
          name: '配件',
          type: 'bar',
          stack: '计划',
          data: [120, 132, 101, 134, 90, 230, 0, 0, 0, 0, 0, 0]
        },
        {
          name: '材料',
          type: 'bar',
          stack: '计划',
          data: [220, 182, 191, 234, 290, 330, 0, 0, 0, 0, 0, 0]
        },
        {
          name: '集采',
          type: 'bar',
          stack: '计划',
          data: [150, 232, 201, 154, 190, 100, 0, 0, 0, 0, 0, 0]
        }
      ]
    };
    option2 = {
      title: {
        text: option.xAxis[0].data[0] + ' 计划统计',
        x: 'center',
        top: 0
      },
      tooltip: {
        trigger: 'item',
        formatter: "{b} : {c} ({d}%)"
      },
      legend: {
        orient: 'horizontal',
        left: 'center',
        data: option.legend.data,
        top: 35
      },
      series: [
        {
          name: option.xAxis[0].data[0],
          type: 'pie',
          radius: '55%',
          center: ['50%', '60%'],
          data: option.series.map(function (s) {
            return {value: s.data[0], name: s.name};
          }),
          itemStyle: {
            emphasis: {
              shadowBlur: 10,
              shadowOffsetX: 0,
              shadowColor: 'rgba(0, 0, 0, 0.5)'
            }
          }
        }
      ]
    };


    // 使用刚指定的配置项和数据显示图表。
    myChart.setOption(option);
    // 处理点击事件并且条状到相应的百度搜索页面
    myChart.on('click', function (params) {
//      console.log(params);
      var name = params.name;
      var idx = option.xAxis[0].data.indexOf(name);
      idx = idx == -1 ? 1 : idx;
      var o2data = option.series.map(function (s) {
        return {value: s.data[idx], name: s.name}
      })

      var ot2 = {
        title: {
          text: name + ' 计划统计',
          x: 'center',
          top: 0
        },
        tooltip: {
          trigger: 'item',
          formatter: "{b} : {c} ({d}%)"
        },
        legend: {
          orient: 'horizontal',
          left: 'center',
          data: ['设备', '配件', '材料', '集采'],
          top: 35
        },
        series: [
          {
            name: name,
            type: 'pie',
            radius: '55%',
            center: ['50%', '60%'],
            data: o2data,
            itemStyle: {
              emphasis: {
                shadowBlur: 10,
                shadowOffsetX: 0,
                shadowColor: 'rgba(0, 0, 0, 0.5)'
              }
            }
          }
        ]
      };
      myChart2.setOption(ot2);
      window.onresize = myChart2.resize;
    });

    myChart2.setOption(option2);
    // 基于准备好的dom，初始化echarts实例
    window.onresize = myChart.resize;
    window.onresize = myChart2.resize;
  })

</script>
<%include footer%>
